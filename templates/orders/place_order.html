{% extends 'base.html' %}
{% load static %}

{% block 'title' %}
    Cart
{% endblock 'title' %}
    


{% block 'content' %}
    <!-- Main Section Start -->
			<div class="main-section">
				
				<div class="page-section">
					<div class="container pt-5">
						<div class="row">
							
							<div class="col-lg-8 col-md-8 col-sm-8 col-xs-12">
								<div class="tabs-holder horizontal">
								<ul class="stickynav-tabs nav nav-tabs">
										<li id='to-hide' class="active"><a data-toggle="tab" href="#home"><i class="icon- icon-shopping_cart"></i>Review of Billing Address</a></li>								
								</ul>							
								
										<div class="tab-content">
											<div id="home" class="tab-pane in active">
												<div class="menu-itam-holder">
													
													<div id="menu-item-list-6272" class="menu-itam-list">
														
														
														<div class="element-title" id="menu-category-2">
															
																											
															
														</div>

														
													</div>
												</div>
											</div>
											
										</div>
									
								</div>
							</div>
							
                            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
								<div class="tabs-holder horizontal">
									<ul class="stickynav-tabs nav nav-tabs">
										<li class="active"><a data-toggle="tab" href="#home"><i class="icon- icon-room_service"></i>Your Orders</a></li>
										
									</ul>
									<div class="tab-content">
										<div id="home" class="tab-pane in active">
											<div class="menu-itam-holder">
												
												<div>
													<ul>
														<li style='list-style-type:none;'>
															<strong>Subtotal</strong>
															<span class='price float-right'>
																<span class='currency'>$</span>
																<span id='subtotal'>{{ sub_total }}</span>		
															</span>
														</li>
														{% for key, value in tax_dict.items %}
																{% for i,j in value.items %}
														<li style='list-style-type:none;'>
															
																	<strong>{{ key }}</strong>
																	<span class='price float-right'>
																		<span class='currency'>$</span>
																		<span id='tax-{{ key }}'>{{ j }}</span>		
																	</span>
																 
														</li>
														{% endfor %}	
															{% endfor %}	
														<li style='list-style-type:none;'>
															<strong>TOTAL</strong>
															<span class='price float-right'>
																<span class='currency'>$</span>
																<span id='total'>{{ total }}</span>		
															</span>
														</li>
													</ul>

													<div class='razorpay_related'>
														<div class='text-center'>
															<button  class='btn btn-danger container-fluid' id="rzp-button1">Pay</button>
														</div>
														<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
													</div>
													
													{% comment %} <a class='btn btn-danger container-fluid' href="{% url 'checkout' %}">PAYMENT</a> {% endcomment %}
												</div>
												
											</div>
										</div>
										
									</div>
								</div>
							</div>
						</div>
                        
					</div>
				</div>
			</div>
			<!-- Main Section End -->
			<script>
				var options = {
					"key": "{{ KEY_ID }}", // Enter the Key ID generated from the Dashboard
					"amount": "{{ order.total }}", // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
					"currency": "INR",
					"name": "FoodOnline",
					"description": "Test Transaction",
					"image": "https://example.com/your_logo",
					"order_id": "{{ rzpay_id }}", //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
					"handler": function (response){
						alert(response.razorpay_payment_id);
						alert(response.razorpay_order_id);
						alert(response.razorpay_signature)
						swal('Paid Sucessfully', '', 'success');

					},
					"prefill": {
						"name": "{{ order.first_name }}",
						"email": "{{ order.email }}",
						"contact": "{{ order.phone }}"
					},
					"notes": {
						"address": "{{ order.address }}"
					},
					"theme": {
						"color": "#3399cc"
					}
				};
				var rzp1 = new Razorpay(options);
				rzp1.on('payment.failed', function (response){
						alert(response.error.code);
						alert(response.error.description);
						alert(response.error.source);
						alert(response.error.step);
						alert(response.error.reason);
						alert(response.error.metadata.order_id);
						alert(response.error.metadata.payment_id);
				});
				document.getElementById('rzp-button1').onclick = function(e){
					rzp1.open();
					e.preventDefault();
				}
				</script>
{% endblock 'content' %}
    